#  _   _    _    ____  __  __                   _         __ _ _      
# | \ | |  / \  / ___||  \/  |  _ __ ___   __ _| | _____ / _(_) | ___ 
# |  \| | / _ \ \___ \| |\/| | | '_ ` _ \ / _` | |/ / _ \ |_| | |/ _ \
# | |\  |/ ___ \ ___) | |  | | | | | | | | (_| |   <  __/  _| | |  __/
# |_| \_/_/   \_\____/|_|  |_| |_| |_| |_|\__,_|_|\_\___|_| |_|_|\___|
#
# Options:
# 	test	- Build and execute
# 	all		- Full build, 3 steps
# 	pre		- Step 1, Preprocess
# 	asm		- Step 2, Assemble
# 	link	- Step 3, Link
# 	clean	- Delete intermediate filer
#
#============================================================
# Executes new build:
#============================================================
test:	rat
	echo "Running rat!" & ./rat rat.asm
#============================================================
# Full 3 step build
#============================================================
all:	rat
	echo "Finished building rat"
rat:	rat.o
	ld -s -o rat rat.o
rat.o:	rat.asm
	nasm -f elf64 rat.asm
#============================================================
# 1. Preprocessing
#============================================================
pre:	rat.asm
	nasm -f elf64 -e -o rat.i rat.asm
#============================================================
# 2. Assemble
#============================================================
asm:	rat.asm
	nasm -f elf64 rat.asm
#============================================================
# 3. Link
#============================================================
link:	rat.o
	ld -s -o rat rat.o
#============================================================
# Remove intermediate files
#============================================================
clean:	rat.o
	rm rat.o rat.i rat

